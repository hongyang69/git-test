
<!DOCTYPE html>   
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html dir="ltr" lang="zh-CN" xmlns:wb="http://open.weibo.com/wb" class="no-js"> <!--<![endif]-->


<!-- BEGIN head -->
<head>

	<!-- Title -->
	<title>Java并发编程：volatile关键字解析 - ImportNew</title>
	
	<!-- Meta Tags -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
	<!-- Favicon & Mobileicon -->
	<link rel="shortcut icon" href="http://www.importnew.com/wp-content/uploads/2014/12/d02a42d9cb3dec9320e5f550278911c7.ico" />
	<link rel="apple-touch-icon" href="http://www.importnew.com/wp-content/themes/jobbolev4blog/mobileicon.png" />
	
	<!-- RSS, Atom & Pingbacks -->
		<link rel="alternate" title="ImportNew RSS Feed" href="http://www.importnew.com/feed" />
		<link rel="alternate" title="RSS .92" href="http://www.importnew.com/feed/rss" />
	<link rel="alternate" title="Atom 0.3" href="http://www.importnew.com/feed/atom" />
	<link rel="pingback" href="http://www.importnew.com/xmlrpc.php" />
	
	<!-- Theme Hook -->
	<link rel='stylesheet' id='lightboxStyle-css'  href='http://www.importnew.com/wp-content/plugins/lightbox-plus/css/shadowed/colorbox.css?ver=2.0.2' type='text/css' media='screen' />
<link rel='stylesheet' id='core3.0-css'  href='http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0' type='text/css' media='all' />
<link rel='stylesheet' id='core-Default3.0-css'  href='http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/styles/shCoreDefault.css?ver=3.0' type='text/css' media='all' />
<link rel='stylesheet' id='theme-Default3.0-css'  href='http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.importnew.com/wp-includes/js/jquery/jquery.js?ver=1.7.2'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/plugins/q2w3-fixed-widget/js/q2w3-fixed-widget.min.js?ver=4.0.6'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/modernizr.js?ver=2.5.3'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-includes/js/comment-reply.js?ver=3.4.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.importnew.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.importnew.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Java命令学习系列（1）：Jps' href='http://www.importnew.com/18132.html' />
<link rel='next' title='跟我学Spring3（8.1）：对ORM的支持之概述' href='http://www.importnew.com/18147.html' />
<link rel='shortlink' href='http://www.importnew.com/?p=18126' />

<!-- All in One SEO Pack 1.6.15.2 by Michael Torbert of Semper Fi Web Design[465,516] -->
<link rel="author" href="liuchi1993" />
<meta name="description" content="volatile这个关键字可能很多朋友都听说过，或许也都用过。在Java 5之前，它是一个备受争议的关键字，因为在程序中使用它往往会导致出人意料的结果。在Java 5之后，volatile关键字才得以重获生机。" />
<meta name="keywords" content="volatile,并发编程" />
<link rel="canonical" href="http://www.importnew.com/18126.html" />
<!-- /all in one seo pack -->

<!-- Comment Rating plugin Version: 2.9.32 by Bob King, http://wealthynetizen.com/, dynamic comment voting & styling. --> 
<style type="text/css" media="screen">
   .ckrating_highly_rated {background-color:#FFFFCC !important;}
   .ckrating_poorly_rated {opacity:0.6;filter:alpha(opacity=60) !important;}
   .ckrating_hotly_debated {background-color:#FFF0F5 !important;}
</style>


<!-- WP SyntaxHighlighter Ver.1.7.3 CSS for code Begin -->
<style type='text/css'>
.syntaxhighlighter,
.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
font-size: 12px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.syntaxhighlighter table caption {
/* For Title(Caption) */  
font-size: 14px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.syntaxhighlighter.nogutter td.code .line {
/* Set the left padding space when no-gutter in ver. 3.0 */  
padding-left: 3px !important;
}
.syntaxhighlighter {
/* For Chrome/Safari(WebKit) */  
/* Hide the superfluous vertical scrollbar in ver. 3.0 */  
overflow-y: hidden !important;
padding: 1px !important;
}
.widget-area.syntaxhighlighter a,
.widget-area.syntaxhighlighter div,
.widget-area.syntaxhighlighter code,
.widget-area.syntaxhighlighter table,
.widget-area.syntaxhighlighter table td,
.widget-area.syntaxhighlighter table tr,
.widget-area.syntaxhighlighter table tbody,
.widget-area.syntaxhighlighter table thead,
.widget-area.syntaxhighlighter table caption,
.widget-area.syntaxhighlighter textarea {
/* For Widget */  
font-size: 14px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
.widget-area table caption {
/* For Widget */  
/* For Title(Caption) */  
font-size: 10px !important; /* Set the font size in pixels */  
font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important; /* Set the font type */  
}
</style>
<!-- WP SyntaxHighlighter Ver.1.7.3 CSS for code End -->
	
	<!-- CSS -->
	<link rel="stylesheet" href="http://www.importnew.com/wp-content/themes/jobbolev4blog/style.css" media="screen" />
	<!-- link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text:400,700italic,700,400italic" media="screen" / -->
	<style>
				*::selection { background: #0099cc; }
		*::-moz-selection { background: #0099cc; }
		body { background: #ffffff  }
		a, .tabs ul.nav li a:hover, .tabs ul.nav li.active a, .dropcap, .toggle.hover .toggle-title, li.comment cite a:hover, h3.widget-title, .post-meta .meta-title:hover, .the-latest a:hover h4, .aw_socialcounter_widget li a:hover, .aw_tabbed_widget #tab-latest-comments a:hover { color: #0099cc; }
		a:hover { color: #b30000; }
		input:focus, textarea:focus { border-color: #0099cc; }
		#searchsubmit, .highlight, .aw_tabbed_widget .tabs ul.nav li.active a, footer .aw_tabbed_widget .tabs ul.nav li.active a, #top .aw_tabbed_widget .tabs ul.nav li.active a, .aw_tabbed_widget .tabs ul.nav li a:hover, footer .aw_tabbed_widget .tabs ul.nav li a:hover, #top .aw_tabbed_widget .tabs ul.nav li a:hover, .aw_twitter_widget .twitter-icon, .testimonial-icon, #top-closed:hover, .flex-control-nav a:hover, .flex-control-nav a.flex-active { background-color: #0099cc; }
		.submit { background-color: #0099cc; border-color: #007399; }
		.submit:hover { background-color: #b30000; border-color: #860000; }
		#searchsubmit:hover { background-color: #b30000; }
		.toggle.hover .toggle-icon { border-top-color: #0099cc; }
		.toggle.hover.active .toggle-icon { border-bottom-color: #0099cc; }
		.flex-direction-nav li .flex-prev:hover { border-right-color: #0099cc; }
		.flex-direction-nav li .flex-next:hover { border-left-color: #0099cc; }
		@media only screen and (min-width: 768px) and (max-width: 959px) {
			.aw_tabbed_widget .tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
		@media screen and (max-width: 767px) {
			.tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
	</style>
		
	<!--[if IE 8]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
    <![endif]-->

	<!-- Links: RSS + Atom Syndication + Pingback etc. -->
	<link rel="alternate" type="application/rss+xml" title="ImportNew RSS Feed" href="http://www.importnew.com/feed" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://www.importnew.com/feed/rss" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://www.importnew.com/feed/atom" />
	<link rel="pingback" href="http://www.importnew.com/xmlrpc.php" />
    <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=2606191112" type="text/javascript" charset="utf-8"></script>

<!-- END head -->
</head>

<!-- BEGIN body -->
<body class="single single-post postid-18126 single-format-standard safari">

		
	
	<!-- BEGIN #top-nav -->
	<nav id="top-nav" class="menu-nav">
		
		<!-- BEGIN .container -->
		<div class="container">

			            <div class="grid-12">
            </div>
			<div class="clear"></div>
		
		</div>
		<!-- END .container -->
    
	</nav>
	<!-- END #top-nav -->
	
	  	
	<!-- BEGIN #wrapper -->
	<div id="wrapper" class="container">

		<!-- BEGIN header -->
		<header>
		
						
			<div class="header-wrapper">
								
				<!-- BEGIN #logo -->
				<div id="logo" class="leaderboard-true">
				
										<a  href="http://www.importnew.com"><img src="http://www.importnew.com/wp-content/uploads/2014/12/6c537425c9ad078efe656a346e5facec.png" width="137" height="85" alt="ImportNew"/></a>
									
				</div>
				<!-- END #logo -->
				
				<!-- BEGIN #leaderboard -->
				<div id="leaderboard">
				
					<a  href="http://blog.jobbole.com/106093/" target="_blank" class="external" rel="nofollow"><img width='728' height='90' src='http://ww1.sinaimg.cn/mw690/bfdcef89gw1f9cf7deatvj20k802idgf.jpg' /></a>				
				</div>
				<!-- END #leaderboard -->
				
				<div class="clear"></div>
			
			</div>
			
						
			<div class="clear"></div>
			
			<!-- BEGIN #main-nav -->
			<nav id="main-nav" class="grid-12 menu-nav">

				<div class="menu-main-container"><ul id="main-nav-menu" class="menu"><li id="menu-item-14265" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14265"><a  href="http://www.importnew.com/">首页</a></li>
<li id="menu-item-14278" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-14278"><a  href="http://www.importnew.com/all-posts">所有文章</a></li>
<li id="menu-item-858" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-858"><a  href="http://www.importnew.com/cat/news">资讯</a></li>
<li id="menu-item-1120" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1120"><a  href="http://www.importnew.com/cat/web-development">Web</a></li>
<li id="menu-item-1923" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1923"><a  href="http://www.importnew.com/cat/architecture">架构</a></li>
<li id="menu-item-832" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-832"><a  href="http://www.importnew.com/cat/basic">基础技术</a></li>
<li id="menu-item-836" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-836"><a  href="http://www.importnew.com/cat/books">书籍</a></li>
<li id="menu-item-2183" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2183"><a  href="http://www.importnew.com/cat/tutorial">教程</a></li>
<li id="menu-item-20858" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20858"><a  href="http://group.jobbole.com/category/tech/java/" class="external" rel="nofollow" target="_blank">Java小组</a></li>
<li id="menu-item-20859" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20859"><a  href="http://hao.jobbole.com/?catid=32" class="external" rel="nofollow" target="_blank">工具资源</a></li>
</ul></div>				
				<div class="clear"></div>
            
			</nav>
			<!-- END #main-nav -->
			
			<div class="clear"></div>
		
		</header>
		<!-- END header -->
		
		

<!-- BEGIN .grid-8 -->
<div class="grid-8">

		
	<!-- BEGIN .post -->
<div class="post-18126 post type-post status-publish format-standard hentry category-basic tag-volatile tag-64 odd" id="post-18126">
	
	<!-- BEGIN .entry-header -->
	<div class="entry-header">
	
				
		<h1>Java并发编程：volatile关键字解析</h1>
		
							
	</div>
	<!-- BEGIN .entry-header -->
	
	<!-- BEGIN .entry-meta -->
	<div class="entry-meta">
	
		<p class="entry-meta-hide-on-mobile">2016/02/28 | 分类： <a  href="http://www.importnew.com/cat/basic" title="查看 基础技术 中的全部文章" rel="category tag">基础技术</a> | <a  href="http://www.importnew.com/18126.html#comments" title="《Java并发编程：volatile关键字解析》上的评论">3  条评论</a>

		 | 标签： <a  href="http://www.importnew.com/tag/volatile">volatile</a>, <a  href="http://www.importnew.com/tag/%e5%b9%b6%e5%8f%91%e7%bc%96%e7%a8%8b">并发编程</a></p>
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style" style="display: block; margin: 0 0px; clear: both;"><span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_fb"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_douban"></a>
<a class="jiathis_button_readitlater"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_ydnote"></a>
<a href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
<a class="jiathis_counter_style"></a>
</div>
<!-- JiaThis Button END -->


	</div>
	<!-- END .entry-meta -->

	<!-- BEGIN .entry -->
	<div class="entry">

        
		<div class='copyright-area'>原文出处： <a ref='nofollow' target='_blank' href='http://www.cnblogs.com/dolphin0520/p/3920373.html'>海子</a></div>
<p>volatile这个关键字可能很多朋友都听说过，或许也都用过。在Java 5之前，它是一个备受争议的关键字，因为在程序中使用它往往会导致出人意料的结果。在Java 5之后，volatile关键字才得以重获生机。</p>
<p>volatile关键字虽然从字面上理解起来比较简单，但是要用好不是一件容易的事情。由于volatile关键字是与Java的内存模型有关的，因此在讲述volatile关键之前，我们先来了解一下与内存模型相关的概念和知识，然后分析了volatile关键字的实现原理，最后给出了几个使用volatile关键字的场景。</p>
<p>以下是本文的目录大纲：</p>
<p>一.内存模型的相关概念</p>
<p>二.并发编程中的三个概念</p>
<p>三.Java内存模型</p>
<p>四..深入剖析volatile关键字</p>
<p>五.使用volatile关键字的场景</p>
<p>若有不正之处请多多谅解，并欢迎批评指正。</p>
<p>请尊重作者劳动成果，转载请标明原文链接：</p>
<p>http://www.cnblogs.com/dolphin0520/p/3920373.html</p>
<h2>一.内存模型的相关概念</h2>
<p>大家都知道，计算机在执行程序时，每条指令都是在CPU中执行的，而执行指令过程中，势必涉及到数据的读取和写入。由于程序运行过程中的临时数据是存放在主存（物理内存）当中的，这时就存在一个问题，由于CPU执行速度很快，而从内存读取数据和向内存写入数据的过程跟CPU执行指令的速度比起来要慢的多，因此如果任何时候对数据的操作都要通过和内存的交互来进行，会大大降低指令执行的速度。因此在CPU里面就有了高速缓存。</p>
<p>也就是，当程序在运行过程中，会将运算需要的数据从主存复制一份到CPU的高速缓存当中，那么CPU进行计算时就可以直接从它的高速缓存读取数据和向其中写入数据，当运算结束之后，再将高速缓存中的数据刷新到主存当中。举个简单的例子，比如下面的这段代码：</p>
<pre class="brush: java; gutter: true">i = i + 1;</pre>
<div></div>
<p>当线程执行这个语句时，会先从主存当中读取i的值，然后复制一份到高速缓存当中，然后CPU执行指令对i进行加1操作，然后将数据写入高速缓存，最后将高速缓存中i最新的值刷新到主存当中。</p>
<p>这个代码在单线程中运行是没有任何问题的，但是在多线程中运行就会有问题了。在多核CPU中，每条线程可能运行于不同的CPU中，因此每个线程运行时有自己的高速缓存（对单核CPU来说，其实也会出现这种问题，只不过是以线程调度的形式来分别执行的）。本文我们以多核CPU为例。</p>
<p>比如同时有2个线程执行这段代码，假如初始时i的值为0，那么我们希望两个线程执行完之后i的值变为2。但是事实会是这样吗？</p>
<p>可能存在下面一种情况：初始时，两个线程分别读取i的值存入各自所在的CPU的高速缓存当中，然后线程1进行加1操作，然后把i的最新值1写入到内存。此时线程2的高速缓存当中i的值还是0，进行加1操作之后，i的值为1，然后线程2把i的值写入内存。</p>
<p>最终结果i的值是1，而不是2。这就是著名的缓存一致性问题。通常称这种被多个线程访问的变量为共享变量。</p>
<p>也就是说，如果一个变量在多个CPU中都存在缓存（一般在多线程编程时才会出现），那么就可能存在缓存不一致的问题。</p>
<p>为了解决缓存不一致性问题，通常来说有以下2种解决方法：</p>
<p>1）通过在总线加LOCK#锁的方式</p>
<p>2）通过缓存一致性协议</p>
<p>这2种方式都是硬件层面上提供的方式。</p>
<p>在早期的CPU当中，是通过在总线上加LOCK#锁的形式来解决缓存不一致的问题。因为CPU和其他部件进行通信都是通过总线来进行的，如果对总线加LOCK#锁的话，也就是说阻塞了其他CPU对其他部件访问（如内存），从而使得只能有一个CPU能使用这个变量的内存。比如上面例子中 如果一个线程在执行 i = i +1，如果在执行这段代码的过程中，在总线上发出了LCOK#锁的信号，那么只有等待这段代码完全执行完毕之后，其他CPU才能从变量i所在的内存读取变量，然后进行相应的操作。这样就解决了缓存不一致的问题。</p>
<p>但是上面的方式会有一个问题，由于在锁住总线期间，其他CPU无法访问内存，导致效率低下。</p>
<p>所以就出现了缓存一致性协议。最出名的就是Intel 的MESI协议，MESI协议保证了每个缓存中使用的共享变量的副本是一致的。它核心的思想是：当CPU写数据时，如果发现操作的变量是共享变量，即在其他CPU中也存在该变量的副本，会发出信号通知其他CPU将该变量的缓存行置为无效状态，因此当其他CPU需要读取这个变量时，发现自己缓存中缓存该变量的缓存行是无效的，那么它就会从内存重新读取。</p>
<p><img src="http://images.cnitblog.com/blog/288799/201408/212219343783699.jpg" alt="" /></p>
<h2>二.并发编程中的三个概念</h2>
<p>在并发编程中，我们通常会遇到以下三个问题：原子性问题，可见性问题，有序性问题。我们先看具体看一下这三个概念：</p>
<p><strong>1.原子性</strong></p>
<p>原子性：即一个操作或者多个操作 要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行。</p>
<p>一个很经典的例子就是银行账户转账问题：</p>
<p>比如从账户A向账户B转1000元，那么必然包括2个操作：从账户A减去1000元，往账户B加上1000元。</p>
<p>试想一下，如果这2个操作不具备原子性，会造成什么样的后果。假如从账户A减去1000元之后，操作突然中止。然后又从B取出了500元，取出500元之后，再执行 往账户B加上1000元 的操作。这样就会导致账户A虽然减去了1000元，但是账户B没有收到这个转过来的1000元。</p>
<p>所以这2个操作必须要具备原子性才能保证不出现一些意外的问题。</p>
<p>同样地反映到并发编程中会出现什么结果呢？</p>
<p>举个最简单的例子，大家想一下假如为一个32位的变量赋值过程不具备原子性的话，会发生什么后果？</p>
<pre class="brush: java; gutter: true">i = 9;</pre>
<div></div>
<p>假若一个线程执行到这个语句时，我暂且假设为一个32位的变量赋值包括两个过程：为低16位赋值，为高16位赋值。</p>
<p>那么就可能发生一种情况：当将低16位数值写入之后，突然被中断，而此时又有一个线程去读取i的值，那么读取到的就是错误的数据。</p>
<p><strong>2.可见性</strong></p>
<p>可见性是指当多个线程访问同一个变量时，一个线程修改了这个变量的值，其他线程能够立即看得到修改的值。</p>
<p>举个简单的例子，看下面这段代码：</p>
<pre class="brush: java; gutter: true">//线程1执行的代码
int i = 0;
i = 10;

//线程2执行的代码
j = i;</pre>
<div></div>
<p>假若执行线程1的是CPU1，执行线程2的是CPU2。由上面的分析可知，当线程1执行 i =10这句时，会先把i的初始值加载到CPU1的高速缓存中，然后赋值为10，那么在CPU1的高速缓存当中i的值变为10了，却没有立即写入到主存当中。</p>
<p>此时线程2执行 j = i，它会先去主存读取i的值并加载到CPU2的缓存当中，注意此时内存当中i的值还是0，那么就会使得j的值为0，而不是10.</p>
<p>这就是可见性问题，线程1对变量i修改了之后，线程2没有立即看到线程1修改的值。</p>
<p><strong>3.有序性</strong></p>
<p>有序性：即程序执行的顺序按照代码的先后顺序执行。举个简单的例子，看下面这段代码：</p>
<pre class="brush: java; gutter: true">int i = 0;              
boolean flag = false;
i = 1;                //语句1  
flag = true;          //语句2</pre>
<div></div>
<p>上面代码定义了一个int型变量，定义了一个boolean类型变量，然后分别对两个变量进行赋值操作。从代码顺序上看，语句1是在语句2前面的，那么JVM在真正执行这段代码的时候会保证语句1一定会在语句2前面执行吗？不一定，为什么呢？这里可能会发生指令重排序（Instruction Reorder）。</p>
<p>下面解释一下什么是指令重排序，一般来说，处理器为了提高程序运行效率，可能会对输入代码进行优化，它不保证程序中各个语句的执行先后顺序同代码中的顺序一致，但是它会保证程序最终执行结果和代码顺序执行的结果是一致的。</p>
<p>比如上面的代码中，语句1和语句2谁先执行对最终的程序结果并没有影响，那么就有可能在执行过程中，语句2先执行而语句1后执行。</p>
<p>但是要注意，虽然处理器会对指令进行重排序，但是它会保证程序最终结果会和代码顺序执行结果相同，那么它靠什么保证的呢？再看下面一个例子：</p>
<div>
<div id="highlighter_165944">
<pre class="brush: java; gutter: true">int a = 10;    //语句1
int r = 2;    //语句2
a = a + 3;    //语句3
r = a*a;     //语句4</pre>
</div>
</div>
<p>这段代码有4个语句，那么可能的一个执行顺序是：</p>
<p><img src="http://images.cnitblog.com/blog/288799/201408/212305263939989.jpg" alt="" /></p>
<p>那么可不可能是这个执行顺序呢： 语句2   语句1    语句4   语句3</p>
<p>不可能，因为处理器在进行重排序时是会考虑指令之间的数据依赖性，如果一个指令Instruction 2必须用到Instruction 1的结果，那么处理器会保证Instruction 1会在Instruction 2之前执行。</p>
<p>虽然重排序不会影响单个线程内程序执行的结果，但是多线程呢？下面看一个例子：</p>
<div></div>
<pre class="brush: java; gutter: true">//线程1:
context = loadContext();   //语句1
inited = true;             //语句2

//线程2:
while(!inited ){
  sleep()
}
doSomethingwithconfig(context);</pre>
<p>上面代码中，由于语句1和语句2没有数据依赖性，因此可能会被重排序。假如发生了重排序，在线程1执行过程中先执行语句2，而此是线程2会以为初始化工作已经完成，那么就会跳出while循环，去执行doSomethingwithconfig(context)方法，而此时context并没有被初始化，就会导致程序出错。</p>
<p>从上面可以看出，指令重排序不会影响单个线程的执行，但是会影响到线程并发执行的正确性。</p>
<p>也就是说，要想并发程序正确地执行，必须要保证原子性、可见性以及有序性。只要有一个没有被保证，就有可能会导致程序运行不正确。</p>
<h2>三.Java内存模型</h2>
<p>在前面谈到了一些关于内存模型以及并发编程中可能会出现的一些问题。下面我们来看一下Java内存模型，研究一下Java内存模型为我们提供了哪些保证以及在java中提供了哪些方法和机制来让我们在进行多线程编程时能够保证程序执行的正确性。</p>
<p>在Java虚拟机规范中试图定义一种Java内存模型（Java Memory Model，JMM）来屏蔽各个硬件平台和操作系统的内存访问差异，以实现让Java程序在各种平台下都能达到一致的内存访问效果。那么Java内存模型规定了哪些东西呢，它定义了程序中变量的访问规则，往大一点说是定义了程序执行的次序。注意，为了获得较好的执行性能，Java内存模型并没有限制执行引擎使用处理器的寄存器或者高速缓存来提升指令执行速度，也没有限制编译器对指令进行重排序。也就是说，在java内存模型中，也会存在缓存一致性问题和指令重排序的问题。</p>
<p>Java内存模型规定所有的变量都是存在主存当中（类似于前面说的物理内存），每个线程都有自己的工作内存（类似于前面的高速缓存）。线程对变量的所有操作都必须在工作内存中进行，而不能直接对主存进行操作。并且每个线程不能访问其他线程的工作内存。</p>
<p>举个简单的例子：在java中，执行下面这个语句：</p>
<pre class="brush: java; gutter: true">i  = 10;</pre>
<div></div>
<p>执行线程必须先在自己的工作线程中对变量i所在的缓存行进行赋值操作，然后再写入主存当中。而不是直接将数值10写入主存当中。</p>
<p>那么Java语言 本身对 原子性、可见性以及有序性提供了哪些保证呢？</p>
<p><strong>1.原子性</strong></p>
<p>在Java中，对基本数据类型的变量的读取和赋值操作是原子性操作，即这些操作是不可被中断的，要么执行，要么不执行。</p>
<p>上面一句话虽然看起来简单，但是理解起来并不是那么容易。看下面一个例子i：</p>
<p>请分析以下哪些操作是原子性操作：</p>
<div>
<div id="highlighter_893999">
<pre class="brush: java; gutter: true">x = 10;         //语句1
y = x;         //语句2
x++;           //语句3
x = x + 1;     //语句4</pre>
</div>
</div>
<p>咋一看，有些朋友可能会说上面的4个语句中的操作都是原子性操作。其实只有语句1是原子性操作，其他三个语句都不是原子性操作。</p>
<p>语句1是直接将数值10赋值给x，也就是说线程执行这个语句的会直接将数值10写入到工作内存中。</p>
<p>语句2实际上包含2个操作，它先要去读取x的值，再将x的值写入工作内存，虽然读取x的值以及 将x的值写入工作内存 这2个操作都是原子性操作，但是合起来就不是原子性操作了。</p>
<p>同样的，x++和 x = x+1包括3个操作：读取x的值，进行加1操作，写入新的值。</p>
<p>所以上面4个语句只有语句1的操作具备原子性。</p>
<p>也就是说，只有简单的读取、赋值（而且必须是将数字赋值给某个变量，变量之间的相互赋值不是原子操作）才是原子操作。</p>
<p>不过这里有一点需要注意：在32位平台下，对64位数据的读取和赋值是需要通过两个操作来完成的，不能保证其原子性。但是好像在最新的JDK中，JVM已经保证对64位数据的读取和赋值也是原子性操作了。</p>
<p>从上面可以看出，Java内存模型只保证了基本读取和赋值是原子性操作，如果要实现更大范围操作的原子性，可以通过synchronized和Lock来实现。由于synchronized和Lock能够保证任一时刻只有一个线程执行该代码块，那么自然就不存在原子性问题了，从而保证了原子性。</p>
<p><strong>2.可见性</strong></p>
<p>对于可见性，Java提供了volatile关键字来保证可见性。</p>
<p>当一个共享变量被volatile修饰时，它会保证修改的值会立即被更新到主存，当有其他线程需要读取时，它会去内存中读取新值。</p>
<p>而普通的共享变量不能保证可见性，因为普通共享变量被修改之后，什么时候被写入主存是不确定的，当其他线程去读取时，此时内存中可能还是原来的旧值，因此无法保证可见性。</p>
<p>另外，通过synchronized和Lock也能够保证可见性，synchronized和Lock能保证同一时刻只有一个线程获取锁然后执行同步代码，并且在释放锁之前会将对变量的修改刷新到主存当中。因此可以保证可见性。</p>
<p><strong>3.有序性</strong></p>
<p>在Java内存模型中，允许编译器和处理器对指令进行重排序，但是重排序过程不会影响到单线程程序的执行，却会影响到多线程并发执行的正确性。</p>
<p>在Java里面，可以通过volatile关键字来保证一定的“有序性”（具体原理在下一节讲述）。另外可以通过synchronized和Lock来保证有序性，很显然，synchronized和Lock保证每个时刻是有一个线程执行同步代码，相当于是让线程顺序执行同步代码，自然就保证了有序性。</p>
<p>另外，<span style="color: #ff0000;">Java内存模型具备一些先天的“有序性”，即不需要通过任何手段就能够得到保证的有序性，这个通常也称为 happens-before 原则。如果两个操作的执行次序无法从happens-before原则推导出来，那么它们就不能保证它们的有序性，虚拟机可以随意地对它们进行重排序。</span></p>
<p>下面就来具体介绍下happens-before原则（先行发生原则）：</p>
<ul>
<li>程序次序规则：一个线程内，按照代码顺序，书写在前面的操作先行发生于书写在后面的操作</li>
<li>锁定规则：一个unLock操作先行发生于后面对同一个锁额lock操作</li>
<li>volatile变量规则：对一个变量的写操作先行发生于后面对这个变量的读操作</li>
<li>传递规则：如果操作A先行发生于操作B，而操作B又先行发生于操作C，则可以得出操作A先行发生于操作C</li>
<li>线程启动规则：Thread对象的start()方法先行发生于此线程的每个一个动作</li>
<li>线程中断规则：对线程interrupt()方法的调用先行发生于被中断线程的代码检测到中断事件的发生</li>
<li>线程终结规则：线程中所有的操作都先行发生于线程的终止检测，我们可以通过Thread.join()方法结束、Thread.isAlive()的返回值手段检测到线程已经终止执行</li>
<li>对象终结规则：一个对象的初始化完成先行发生于他的finalize()方法的开始</li>
</ul>
<p>这8条原则摘自《深入理解Java虚拟机》。</p>
<p>这8条规则中，前4条规则是比较重要的，后4条规则都是显而易见的。</p>
<p>下面我们来解释一下前4条规则：</p>
<p>对于程序次序规则来说，我的理解就是一段程序代码的执行在单个线程中看起来是有序的。注意，虽然这条规则中提到“书写在前面的操作先行发生于书写在后面的操作”，这个应该是程序看起来执行的顺序是按照代码顺序执行的，因为虚拟机可能会对程序代码进行指令重排序。虽然进行重排序，但是最终执行的结果是与程序顺序执行的结果一致的，它只会对不存在数据依赖性的指令进行重排序。因此，在单个线程中，程序执行看起来是有序执行的，这一点要注意理解。事实上，这个规则是用来保证程序在单线程中执行结果的正确性，但无法保证程序在多线程中执行的正确性。</p>
<p>第二条规则也比较容易理解，也就是说无论在单线程中还是多线程中，同一个锁如果出于被锁定的状态，那么必须先对锁进行了释放操作，后面才能继续进行lock操作。</p>
<p>第三条规则是一条比较重要的规则，也是后文将要重点讲述的内容。直观地解释就是，如果一个线程先去写一个变量，然后一个线程去进行读取，那么写入操作肯定会先行发生于读操作。</p>
<p>第四条规则实际上就是体现happens-before原则具备传递性。</p>
<h2>四.深入剖析volatile关键字</h2>
<p>在前面讲述了很多东西，其实都是为讲述volatile关键字作铺垫，那么接下来我们就进入主题。</p>
<p><strong>1.volatile关键字的两层语义</strong></p>
<p>一旦一个共享变量（类的成员变量、类的静态成员变量）被volatile修饰之后，那么就具备了两层语义：</p>
<p>1）保证了不同线程对这个变量进行操作时的可见性，即一个线程修改了某个变量的值，这新值对其他线程来说是立即可见的。</p>
<p>2）禁止进行指令重排序。</p>
<p>先看一段代码，假如线程1先执行，线程2后执行：</p>
<pre class="brush: java; gutter: true">//线程1
boolean stop = false;
while(!stop){
    doSomething();
}

//线程2
stop = true;</pre>
<div></div>
<p>这段代码是很典型的一段代码，很多人在中断线程时可能都会采用这种标记办法。但是事实上，这段代码会完全运行正确么？即一定会将线程中断么？不一定，也许在大多数时候，这个代码能够把线程中断，但是也有可能会导致无法中断线程（虽然这个可能性很小，但是只要一旦发生这种情况就会造成死循环了）。</p>
<p>下面解释一下这段代码为何有可能导致无法中断线程。在前面已经解释过，每个线程在运行过程中都有自己的工作内存，那么线程1在运行的时候，会将stop变量的值拷贝一份放在自己的工作内存当中。</p>
<p>那么当线程2更改了stop变量的值之后，但是还没来得及写入主存当中，线程2转去做其他事情了，那么线程1由于不知道线程2对stop变量的更改，因此还会一直循环下去。</p>
<p>但是用volatile修饰之后就变得不一样了：</p>
<p>第一：使用volatile关键字会强制将修改的值立即写入主存；</p>
<p>第二：使用volatile关键字的话，当线程2进行修改时，会导致线程1的工作内存中缓存变量stop的缓存行无效（反映到硬件层的话，就是CPU的L1或者L2缓存中对应的缓存行无效）；</p>
<p>第三：由于线程1的工作内存中缓存变量stop的缓存行无效，所以线程1再次读取变量stop的值时会去主存读取。</p>
<p>那么在线程2修改stop值时（当然这里包括2个操作，修改线程2工作内存中的值，然后将修改后的值写入内存），会使得线程1的工作内存中缓存变量stop的缓存行无效，然后线程1读取时，发现自己的缓存行无效，它会等待缓存行对应的主存地址被更新之后，然后去对应的主存读取最新的值。</p>
<p>那么线程1读取到的就是最新的正确的值。</p>
<p><strong>2.volatile保证原子性吗？</strong></p>
<p>从上面知道volatile关键字保证了操作的可见性，但是volatile能保证对变量的操作是原子性吗？</p>
<p>下面看一个例子：</p>
<pre class="brush: java; gutter: true">public class Test {
    public volatile int inc = 0;

    public void increase() {
        inc++;
    }

    public static void main(String[] args) {
        final Test test = new Test();
        for(int i=0;i&lt;10;i++){
            new Thread(){
                public void run() {
                    for(int j=0;j&lt;1000;j++)
                        test.increase();
                };
            }.start();
        }

        while(Thread.activeCount()&gt;1)  //保证前面的线程都执行完
            Thread.yield();
        System.out.println(test.inc);
    }
}</pre>
<div></div>
<p>大家想一下这段程序的输出结果是多少？也许有些朋友认为是10000。但是事实上运行它会发现每次运行结果都不一致，都是一个小于10000的数字。</p>
<p>可能有的朋友就会有疑问，不对啊，上面是对变量inc进行自增操作，由于volatile保证了可见性，那么在每个线程中对inc自增完之后，在其他线程中都能看到修改后的值啊，所以有10个线程分别进行了1000次操作，那么最终inc的值应该是1000*10=10000。</p>
<p>这里面就有一个误区了，volatile关键字能保证可见性没有错，但是上面的程序错在没能保证原子性。可见性只能保证每次读取的是最新的值，但是volatile没办法保证对变量的操作的原子性。</p>
<p>在前面已经提到过，自增操作是不具备原子性的，它包括读取变量的原始值、进行加1操作、写入工作内存。那么就是说自增操作的三个子操作可能会分割开执行，就有可能导致下面这种情况出现：</p>
<p>假如某个时刻变量inc的值为10，</p>
<p>线程1对变量进行自增操作，线程1先读取了变量inc的原始值，然后线程1被阻塞了；</p>
<p>然后线程2对变量进行自增操作，线程2也去读取变量inc的原始值，由于线程1只是对变量inc进行读取操作，而没有对变量进行修改操作，所以不会导致线程2的工作内存中缓存变量inc的缓存行无效，所以线程2会直接去主存读取inc的值，发现inc的值时10，然后进行加1操作，并把11写入工作内存，最后写入主存。</p>
<p>然后线程1接着进行加1操作，由于已经读取了inc的值，注意此时在线程1的工作内存中inc的值仍然为10，所以线程1对inc进行加1操作后inc的值为11，然后将11写入工作内存，最后写入主存。</p>
<p>那么两个线程分别进行了一次自增操作后，inc只增加了1。</p>
<p>解释到这里，可能有朋友会有疑问，不对啊，前面不是保证一个变量在修改volatile变量时，会让缓存行无效吗？然后其他线程去读就会读到新的值，对，这个没错。这个就是上面的happens-before规则中的volatile变量规则，但是要注意，线程1对变量进行读取操作之后，被阻塞了的话，并没有对inc值进行修改。然后虽然volatile能保证线程2对变量inc的值读取是从内存中读取的，但是线程1没有进行修改，所以线程2根本就不会看到修改的值。</p>
<p>根源就在这里，自增操作不是原子性操作，而且volatile也无法保证对变量的任何操作都是原子性的。</p>
<p>把上面的代码改成以下任何一种都可以达到效果：</p>
<p>采用synchronized：</p>
<pre class="brush: java; gutter: true">public class Test {
    public  int inc = 0;

    public synchronized void increase() {
        inc++;
    }

    public static void main(String[] args) {
        final Test test = new Test();
        for(int i=0;i&lt;10;i++){
            new Thread(){
                public void run() {
                    for(int j=0;j&lt;1000;j++)
                        test.increase();
                };
            }.start();
        }

        while(Thread.activeCount()&gt;1)  //保证前面的线程都执行完
            Thread.yield();
        System.out.println(test.inc);
    }
}</pre>
<p>采用Lock：</p>
<div>
<pre class="brush: java; gutter: true">public class Test {
    public  int inc = 0;
    Lock lock = new ReentrantLock();

    public  void increase() {
        lock.lock();
        try {
            inc++;
        } finally{
            lock.unlock();
        }
    }

    public static void main(String[] args) {
        final Test test = new Test();
        for(int i=0;i&lt;10;i++){
            new Thread(){
                public void run() {
                    for(int j=0;j&lt;1000;j++)
                        test.increase();
                };
            }.start();
        }

        while(Thread.activeCount()&gt;1)  //保证前面的线程都执行完
            Thread.yield();
        System.out.println(test.inc);
    }
}</pre>
</div>
<p>采用AtomicInteger：</p>
<div>
<pre class="brush: java; gutter: true">public class Test {
    public  AtomicInteger inc = new AtomicInteger();

    public  void increase() {
        inc.getAndIncrement();
    }

    public static void main(String[] args) {
        final Test test = new Test();
        for(int i=0;i&lt;10;i++){
            new Thread(){
                public void run() {
                    for(int j=0;j&lt;1000;j++)
                        test.increase();
                };
            }.start();
        }

        while(Thread.activeCount()&gt;1)  //保证前面的线程都执行完
            Thread.yield();
        System.out.println(test.inc);
    }
}</pre>
</div>
<p>在java 1.5的java.util.concurrent.atomic包下提供了一些原子操作类，即对基本数据类型的 自增（加1操作），自减（减1操作）、以及加法操作（加一个数），减法操作（减一个数）进行了封装，保证这些操作是原子性操作。atomic是利用CAS来实现原子性操作的（Compare And Swap），CAS实际上是利用处理器提供的CMPXCHG指令实现的，而处理器执行CMPXCHG指令是一个原子性操作。</p>
<p><strong>3.volatile能保证有序性吗？</strong></p>
<p>在前面提到volatile关键字能禁止指令重排序，所以volatile能在一定程度上保证有序性。</p>
<p>volatile关键字禁止指令重排序有两层意思：</p>
<p>1）当程序执行到volatile变量的读操作或者写操作时，在其前面的操作的更改肯定全部已经进行，且结果已经对后面的操作可见；在其后面的操作肯定还没有进行；</p>
<p>2）在进行指令优化时，不能将在对volatile变量访问的语句放在其后面执行，也不能把volatile变量后面的语句放到其前面执行。</p>
<p>可能上面说的比较绕，举个简单的例子：</p>
<pre class="brush: java; gutter: true">//x、y为非volatile变量
//flag为volatile变量

x = 2;        //语句1
y = 0;        //语句2
flag = true;  //语句3
x = 4;         //语句4
y = -1;       //语句5</pre>
<div></div>
<p>由于flag变量为volatile变量，那么在进行指令重排序的过程的时候，不会将语句3放到语句1、语句2前面，也不会讲语句3放到语句4、语句5后面。但是要注意语句1和语句2的顺序、语句4和语句5的顺序是不作任何保证的。</p>
<p>并且volatile关键字能保证，执行到语句3时，语句1和语句2必定是执行完毕了的，且语句1和语句2的执行结果对语句3、语句4、语句5是可见的。</p>
<p>那么我们回到前面举的一个例子：</p>
<pre class="brush: java; gutter: true">//线程1:
context = loadContext();   //语句1
inited = true;             //语句2

//线程2:
while(!inited ){
  sleep()
}
doSomethingwithconfig(context);</pre>
<div></div>
<p>前面举这个例子的时候，提到有可能语句2会在语句1之前执行，那么久可能导致context还没被初始化，而线程2中就使用未初始化的context去进行操作，导致程序出错。</p>
<p>这里如果用volatile关键字对inited变量进行修饰，就不会出现这种问题了，因为当执行到语句2时，必定能保证context已经初始化完毕。</p>
<p><strong>4.volatile的原理和实现机制</strong></p>
<p>前面讲述了源于volatile关键字的一些使用，下面我们来探讨一下volatile到底如何保证可见性和禁止指令重排序的。</p>
<p>下面这段话摘自《深入理解Java虚拟机》：</p>
<p>“观察加入volatile关键字和没有加入volatile关键字时所生成的汇编代码发现，加入volatile关键字时，会多出一个lock前缀指令”</p>
<p>lock前缀指令实际上相当于一个内存屏障（也成内存栅栏），内存屏障会提供3个功能：</p>
<p>1）它确保指令重排序时不会把其后面的指令排到内存屏障之前的位置，也不会把前面的指令排到内存屏障的后面；即在执行到内存屏障这句指令时，在它前面的操作已经全部完成；</p>
<p>2）它会强制将对缓存的修改操作立即写入主存；</p>
<p>3）如果是写操作，它会导致其他CPU中对应的缓存行无效。</p>
<h2>五.使用volatile关键字的场景</h2>
<p>synchronized关键字是防止多个线程同时执行一段代码，那么就会很影响程序执行效率，而volatile关键字在某些情况下性能要优于synchronized，但是要注意volatile关键字是无法替代synchronized关键字的，因为volatile关键字无法保证操作的原子性。通常来说，使用volatile必须具备以下2个条件：</p>
<p>1）对变量的写操作不依赖于当前值</p>
<p>2）该变量没有包含在具有其他变量的不变式中</p>
<p>实际上，这些条件表明，可以被写入 volatile 变量的这些有效值独立于任何程序的状态，包括变量的当前状态。</p>
<p>事实上，我的理解就是上面的2个条件需要保证操作是原子性操作，才能保证使用volatile关键字的程序在并发时能够正确执行。</p>
<p>下面列举几个Java中使用volatile的几个场景。</p>
<p><strong>1.状态标记量</strong></p>
<div>
<div id="highlighter_624077">
<pre class="brush: java; gutter: true">volatile boolean flag = false;

while(!flag){
    doSomething();
}

public void setFlag() {
    flag = true;
}</pre>
</div>
</div>
<div>
<div id="highlighter_981107">
<pre class="brush: java; gutter: true">volatile boolean inited = false;
//线程1:
context = loadContext();  
inited = true;            

//线程2:
while(!inited ){
sleep()
}
doSomethingwithconfig(context);</pre>
</div>
</div>
<p>&nbsp;</p>
<p><strong>2.double check</strong></p>
<div>
<div id="highlighter_303000">
<pre class="brush: java; gutter: true">class Singleton{
    private volatile static Singleton instance = null;

    private Singleton() {

    }

    public static Singleton getInstance() {
        if(instance==null) {
            synchronized (Singleton.class) {
                if(instance==null)
                    instance = new Singleton();
            }
        }
        return instance;
    }
}</pre>
</div>
</div>
<p>至于为何需要这么写请参考：</p>
<p>《Java 中的双重检查（Double-Check）》<a  href="http://blog.csdn.net/dl88250/article/details/5439024" target="_blank" class="external" rel="nofollow">http://blog.csdn.net/dl88250/article/details/5439024</a></p>
<p>和<a  href="http://www.iteye.com/topic/652440" class="external" rel="nofollow" target="_blank">http://www.iteye.com/topic/652440</a></p>
<p>参考资料：</p>
<p>《<span class='wp_keywordlink'><a  href="http://www.amazon.cn/gp/product/B0011F7WU4/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&#038;camp=536&#038;creative=3200&#038;creativeASIN=B0011F7WU4&#038;linkCode=as2&#038;tag=importnew-23" title="Java编程思想(第4版) " rel="nofollow" target="_blank" class="external">Java编程思想</a></span>》</p>
<p>《深入理解Java虚拟机》</p>
<p><a  href="http://jiangzhengjun.iteye.com/blog/652532" target="_blank" class="external" rel="nofollow">http://jiangzhengjun.iteye.com/blog/652532</a></p>
<p><a  href="http://blog.sina.com.cn/s/blog_7bee8dd50101fu8n.html" target="_blank" class="external" rel="nofollow">http://blog.sina.com.cn/s/blog_7bee8dd50101fu8n.html</a></p>
<p><a  href="http://ifeve.com/volatile/" target="_blank" class="external" rel="nofollow">http://ifeve.com/volatile/</a></p>
<p><a  href="http://blog.csdn.net/ccit0519/article/details/11241403" target="_blank" class="external" rel="nofollow">http://blog.csdn.net/ccit0519/article/details/11241403</a></p>
<p><a  href="http://blog.csdn.net/ns_code/article/details/17101369" target="_blank" class="external" rel="nofollow">http://blog.csdn.net/ns_code/article/details/17101369</a></p>
<p><a  href="http://www.cnblogs.com/kevinwu/archive/2012/05/02/2479464.html" target="_blank" class="external" rel="nofollow">http://www.cnblogs.com/kevinwu/archive/2012/05/02/2479464.html</a></p>
<p><a  href="http://www.cppblog.com/elva/archive/2011/01/21/139019.html" target="_blank" class="external" rel="nofollow">http://www.cppblog.com/elva/archive/2011/01/21/139019.html</a></p>
<p><a  href="http://ifeve.com/volatile-array-visiblity/" target="_blank" class="external" rel="nofollow">http://ifeve.com/volatile-array-visiblity/</a></p>
<p><a  href="http://www.bdqn.cn/news/201312/12579.shtml" target="_blank" class="external" rel="nofollow">http://www.bdqn.cn/news/201312/12579.shtml</a></p>
<p><a  href="http://exploer.blog.51cto.com/7123589/1193399" target="_blank" class="external" rel="nofollow">http://exploer.blog.51cto.com/7123589/1193399</a></p>
<p><a  href="http://www.cnblogs.com/Mainz/p/3556430.html" target="_blank" class="external" rel="nofollow">http://www.cnblogs.com/Mainz/p/3556430.html</a></p>

        
        
        <!-- BEGIN #author-bio -->


<!-- END #author-bio -->
	</div>
	<!-- END .entry -->


<!-- JiaThis Button BEGIN -->
<div class="jiathis_style_24x24">
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_fb"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_douban"></a>
<a class="jiathis_button_googleplus"></a>
<a class="jiathis_button_readitlater"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_ydnote"></a>
<a  href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis external" target="_blank" rel="nofollow"></a>
<a class="jiathis_counter_style"></a>
</div>


<script type="text/javascript" >
var jiathis_config={
	data_track_clickback:false,
	title:"《Java并发编程：volatile关键字解析》",
	summary:"volatile这个关键字可能很多朋友都听说过，或许也都用过。在Java 5之前，它是一个备受争议的关键字，因为在程序中使用它往往会导致出人意料的结果。在Java 5之后，volatile关键字才得以重获生机。",
	pic:"http://incdn1.b0.upaiyun.com/2016/02/5a7ce0b39fb88e69854124d89bbc2a38.jpg",
	appkey:{
                "tsina":2284713194 //for importnew
        },
	ralateuid:{
		"tsina":2991905905 //for importnew
	},
	hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1745061" charset="utf-8"></script>
<!-- JiaThis Button END -->
<br/><br/>
<div id="text-13">			<div class="textwidget"><p><a  href="http://blog.jobbole.com/106093/" target="_blank" class="external" rel="nofollow"><img src='http://ww1.sinaimg.cn/mw690/bfdcef89gw1f9cf7iwi24j20h802sjrz.jpg' /></a></p>
</div>
		</div>
</div>
<!-- END .post -->	
	
<script type="text/javascript">
window._wp_rp_static_base_url = "http://dtmvdvtzf8rz0.cloudfront.net/static/";

</script>
<h3  class="related_post_title">相关文章</h3><ul class="related_post wp_rp" style="visibility:visible;"><li position="0"><a  href="http://www.importnew.com/20794.html">Java并发编程（18）：第五篇中volatile意外问题的正确分析解答（含代码）</a></li><li position="1"><a  href="http://www.importnew.com/20741.html">Java并发编程（15）：并发编程中实现内存可见的两种方法比较—加锁和volatile变量</a></li><li position="2"><a  href="http://www.importnew.com/20594.html">Java JUC之Atomic系列12大类实例讲解和原理分解</a></li><li position="3"><a  href="http://www.importnew.com/20566.html">Java并发编程（5）：volatile变量修饰符—意料之外的问题（含代码）</a></li><li position="4"><a  href="http://www.importnew.com/20116.html">并发编程模型</a></li><li position="5"><a  href="http://www.importnew.com/19745.html">happens-before俗解</a></li><li position="6"><a  href="http://www.importnew.com/19727.html">Java8并发教程：Threads和Executors </a></li><li position="7"><a  href="http://www.importnew.com/19434.html">关于Java变量的可见性问题</a></li><li position="8"><a  href="http://www.importnew.com/18523.html">Java并发编程：synchronized</a></li><li position="9"><a  href="http://www.importnew.com/18320.html">Java并发编程：Lock</a></li></ul>

			
	
<!-- BEGIN #respond -->
<div id="respond">

	<h3 class="widget-title">发表评论</h3>
	
	<!-- BEGIN .cancel-comment-reply -->
	<p class="cancel-comment-reply">
		
		<a  rel="nofollow" id="cancel-comment-reply-link" href="/18126.html#respond" style="display:none;">点击这里取消回复。</a>		
	</p>
	<!-- END .cancel-comment-reply -->

		
	<!-- BEGIN #comment-form -->
	<form action="http://www.importnew.com/wp-comments-post.php" method="post" id="comment-form">
		
		<fieldset>
		
			<legend class="none">Comment form</legend>
			
			<!-- BEGIN .container -->
			<div class="container">
			
							
				<div class="grid-4 margin-20">
					<label for="author">Name<span class="red">*</span></label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="text" name="author" id="author" value="" tabindex="1" size="30" class="required" placeholder="姓名" /></div>
				</div>
				<div class="clear"></div>
				
				<div class="grid-4 margin-20">
					<label for="email">邮箱<span class="red">*</span></label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="email" name="email" id="email" value="" tabindex="2" size="30" class="required email" placeholder="请填写邮箱" /></div>
				</div>
				<div class="clear"></div>
				
				<div class="grid-4 margin-20">
					<label for="url">网站 (请以 http://开头)</label>
				</div>
				
				<div class="grid-4 margin-20">
					<div class="input-wrapper"><input type="url" name="url" id="url" value="" tabindex="3" size="30" placeholder="请填写网站地址" /></div>
				</div>
				<div class="clear"></div>
				
								
				<div class="grid-8 margin-20">
					<label for="comment" class="none margin-20">评论内容<span class="red">*</span></label>
					<div class="input-wrapper"><textarea name="comment" id="comment" rows="20" cols="30" class="required" tabindex="4" onkeydown="if(event.ctrlKey && event.keyCode==13){document.getElementById('comment-form-submit').click(); return false;}" placeholder="请填写评论内容" ></textarea></div>
				</div>
				<div class="clear"></div>
				
			</div>
			<!-- END .container -->
			
			<p>(<span class="red">*</span>) 表示必填项</p>
			<p><div class="submit-wrapper"><a id="comment-form-submit" class="submit">提交评论</a></div></p>
			<input type='hidden' name='comment_post_ID' value='18126' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
			<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ff29b1cd9e" /></p>			
		</fieldset>
		
	</form>
	<!-- END #comment-form -->
	
	
</div>
<!-- END #respond -->

	<h3 id="comments" class="widget-title">3 条评论</h3>
	
	<!-- BEGIN .commentlist -->
	<ol class="commentlist">
	
				<li class="comment even thread-even depth-1 parent" id="comment-486326">
				<div id="div-comment-486326" class="comment-body">
				<div class="comment-author vcard">
				<cite class="fn"><a  href="http://www.jisumayi.com" rel="external nofollow" class="url external" target="_blank">cyfonly</a></cite> <span class="says">说道：</span>		</div>

		<div class="comment-meta commentmetadata"><a  href="http://www.importnew.com/18126.html#comment-486326">
			2016/03/03 上午 10:59</a>		</div>

		<p>【解释到这里，可能有朋友会有疑问，不对啊，前面不是保证一个变量在修改volatile变量时，会让缓存行无效吗？然后其他线程去读就会读到新的值，对，这个没错。这个就是上面的happens-before规则中的volatile变量规则，但是要注意，线程1对变量进行读取操作之后，被阻塞了的话，并没有对inc值进行修改。然后虽然volatile能保证线程2对变量inc的值读取是从内存中读取的，但是线程1没有进行修改，所以线程2根本就不会看到修改的值。】<br />
针对这一段，我有个疑问请教下博主。当线程2修改inc值后（指写入到主存），不是一样会让线程1中的inc缓存行无效么？这个时候线程1按理来说是要重新到主存中读取inc的值（11），然后再自增1，所以我认为最后值应该还是12。麻烦博主解释下，谢谢</p>
<p> <img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="up-486326" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_up.png" alt="Thumb up" onclick="javascript:ckratingKarma('486326', 'add', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_');" title="赞同" /> <span id="karma-486326-up" style="font-size:12px; color:#009933;">3</span>&nbsp;<img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="down-486326" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_down.png" alt="Thumb down" onclick="javascript:ckratingKarma('486326', 'subtract', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_')" title="反对" /> <span id="karma-486326-down" style="font-size:12px; color:#990033;">0</span></p>
		<div class="reply">
		<a  class="comment-reply-link" href="/18126.html?replytocom=486326#respond" onclick="return addComment.moveForm("div-comment-486326", "486326", "respond", "18126")">回复</a>		</div>
				</div>
		<ul class='children'>
		<li class="comment odd alt depth-2" id="comment-486850">
				<div id="div-comment-486850" class="comment-body">
				<div class="comment-author vcard">
				<cite class="fn">mongoose</cite> <span class="says">说道：</span>		</div>

		<div class="comment-meta commentmetadata"><a  href="http://www.importnew.com/18126.html#comment-486850">
			2016/03/08 下午 8:07</a>		</div>

		<p>线程1的读取操作是在线程二的写操作之前发生的。以我的理解，这其实执行了下面的伪汇编代码（因为我忘记了汇编代码的具体格式了）</p>
<p>1） lock  ；应该是具体的将主存中的数据读到cache中的操作，我并不知道具体格式是什么<br />
2） mov ax, 01h   ；假设x的值存放在主存的0&#215;01处，但是实际由于通过cpu cache的映射关系，实际是从cache中获得的，只是由于第一句的block指令，让cache中的数据其实和主存中是一样的<br />
3） inc ax<br />
4） mov 01h, ax<br />
5） lock ； cache中的内容写入主存</p>
<p>以上是线程1的操作，博主的例子是说，线程2的读操作是在1之后，4之前或者5之前，不过这都不重要。你说的线程2对于x的写只要在1之后发生的对于线程1都是无能为力的，因为对于线程1来说，已经没有x了，都是寄存器和自己的cache了。</p>
<p> <img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="up-486850" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_up.png" alt="Thumb up" onclick="javascript:ckratingKarma('486850', 'add', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_');" title="赞同" /> <span id="karma-486850-up" style="font-size:12px; color:#009933;">0</span>&nbsp;<img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="down-486850" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_down.png" alt="Thumb down" onclick="javascript:ckratingKarma('486850', 'subtract', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_')" title="反对" /> <span id="karma-486850-down" style="font-size:12px; color:#990033;">0</span></p>
		<div class="reply">
		<a  class="comment-reply-link" href="/18126.html?replytocom=486850#respond" onclick="return addComment.moveForm("div-comment-486850", "486850", "respond", "18126")">回复</a>		</div>
				</div>
		</li>
</ul>
</li>
		<li class="comment even thread-odd thread-alt depth-1" id="comment-487304">
				<div id="div-comment-487304" class="comment-body">
				<div class="comment-author vcard">
				<cite class="fn"><a  href="http://www.wonpang.net" rel="external nofollow" class="url external" target="_blank">鲨鱼辣椒</a></cite> <span class="says">说道：</span>		</div>

		<div class="comment-meta commentmetadata"><a  href="http://www.importnew.com/18126.html#comment-487304">
			2016/03/12 下午 1:03</a>		</div>

		<p>讲的真是太详细，受教！</p>
<p> <img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="up-487304" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_up.png" alt="Thumb up" onclick="javascript:ckratingKarma('487304', 'add', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_');" title="赞同" /> <span id="karma-487304-up" style="font-size:12px; color:#009933;">0</span>&nbsp;<img style="padding: 0px; border: none; cursor: pointer;" onmouseover="this.width=this.width*1.3" onmouseout="this.width=this.width/1.2" id="down-487304" src="http://www.importnew.com/wp-content/plugins/comment-rating/images/1_14_down.png" alt="Thumb down" onclick="javascript:ckratingKarma('487304', 'subtract', 'www.importnew.com/wp-content/plugins/comment-rating/', '1_14_')" title="反对" /> <span id="karma-487304-down" style="font-size:12px; color:#990033;">0</span></p>
		<div class="reply">
		<a  class="comment-reply-link" href="/18126.html?replytocom=487304#respond" onclick="return addComment.moveForm("div-comment-487304", "487304", "respond", "18126")">回复</a>		</div>
				</div>
		</li>
	
	</ol>

	<!-- END .commentlist -->

		
 



		
				
	<!-- BEGIN .navigation -->
	<div class="navigation margin-20">
	
		<div class="alignleft"><a  href="http://www.importnew.com/18132.html" rel="prev">&laquo; Java命令学习系列（1）：Jps</a></div>
		<div class="alignright"><a  href="http://www.importnew.com/18167.html" rel="next">探秘Java中String、StringBuilder以及StringBuffer &raquo;</a></div>
		<div class="clear"></div>

	</div>
	<!-- END .navigation -->
	
		
</div>
<!-- END .grid-8 -->

<!-- BEGIN #sidebar -->
<div id="sidebar" class="grid-4">

	<div id="search-3" class="widget widget_search"><!-- BEGIN #searchform -->
<form method="get" id="searchform" action="http://www.importnew.com/">

	<label class="none" for="s">Search for:</label>
	<div class="input-wrapper"><input type="text" value="" name="s" id="s" placeholder="Search" /></div>
	<input type="submit" id="searchsubmit" value="Search" />
	
</form>
<!-- END #searchform --></div><div id="text-14" class="widget widget_text">			<div class="textwidget"><p><a  href="http://blog.jobbole.com/84342/?utm_source=www.importnew.com&#038;utm_medium=rightBanner-1&#038;utm_content=2015.9.16" target="_blank" class="external" rel="nofollow"><img src='http://ww2.sinaimg.cn/mw690/e5298966gw1evyjrd4iqcj208c03c0t0.jpg' /></a></p>
</div>
		</div><div id="aw_tabbed_widget-2" class="widget aw_tabbed_widget"><div class="tabs"><ul class="nav clearfix"><li><a  id="link-most-discussed" href="#tab-most-discussed" title="本周热门文章">本周热门文章</a></li><li><a  id="link-latest-comments" href="#tab-latest-comments" title="本月热门">本月热门</a></li><li><a  id="link-tags" href="#tab-tags" title="热门标签">热门标签</a></li></ul><div id="tab-most-discussed" class="tab"><div class="floated-thumb">							
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">0</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22971.html" title="Lock 那点事儿">Lock 那点事儿</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">1</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22908.html" title="在Spring MVC中使用Apache Shiro安全框架">在Spring MVC中使用Apache Shi...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">2</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22977.html" title="理解Compressed Sparse Column Format (CSC)">理解Compressed Sparse Column Fo...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">3</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22941.html" title="适应各种开发，测试，线上，线下环境的Spring配置方式">适应各种开发，测试，线上，线下环境的S...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">4</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22945.html" title="关于Java并发编程的总结和思考">关于Java并发编程的总结和思考</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">5</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22952.html" title="Apache HttpClient 没有设置time out导致应用长时间阻塞的问题">Apache HttpClient 没有设置time ...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">6</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22956.html" title="写程序很难之去除字符串的空白字符">写程序很难之去除字符串的空白字符</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">7</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22983.html" title="统计分析工程的依赖项">统计分析工程的依赖项</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">8</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22987.html" title="Jackson 通过自定义注解来控制json key的格式 ">Jackson 通过自定义注解来控制json ...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
							
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">9</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22992.html" title="利用github搭建个人maven仓库">利用github搭建个人maven仓库</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
						</div></div><div id="tab-latest-comments" class="tab"><div class="floated-thumb">							
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">0</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22637.html" title="面试心得与总结---BAT、网易、蘑菇街">面试心得与总结---BAT、网易、...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">1</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22705.html" title="ThreadPoolExecutor使用错误导致死锁">ThreadPoolExecutor使用错误导致...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">2</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22732.html" title="谈谈互联网后端基础设施">谈谈互联网后端基础设施</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">3</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22890.html" title="Quartz 入门详解">Quartz 入门详解</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">4</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22971.html" title="Lock 那点事儿">Lock 那点事儿</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">5</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22914.html" title="Mybatis的ResultMap的使用">Mybatis的ResultMap的使用</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">6</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22757.html" title="Spring Cache">Spring Cache</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">7</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22783.html" title="MyBatis（1）：MyBatis入门">MyBatis（1）：MyBatis入门</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">8</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22821.html" title="几种简单的负载均衡算法及其Java代码实现 ">几种简单的负载均衡算法及其Java代...</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
													
											
							<!-- BEGIN .post-meta -->
							<div class="post-meta ">
							
								<p>
								    <span class="numb">9</span>
								    <a  class="meta-title" target="_blank" href="http://www.importnew.com/22859.html" title="spring核心框架体系结构">spring核心框架体系结构</a><br />
								</p>
									
							</div>
							<!-- END .post-meta -->
							
							<div class="clear"></div>
							
						</div></div><div id="tab-tags" class="tab"><p><a  href="http://www.importnew.com/tag/android23days" class="tag-link-240" title="8 个话题" style="font-size: 9.12px;">android23days</a>
<a  href="http://www.importnew.com/tag/android" class="tag-link-36" title="64 个话题" style="font-size: 18.752px;">Android开发</a>
<a  href="http://www.importnew.com/tag/aop" class="tag-link-204" title="15 个话题" style="font-size: 11.92px;">AOP</a>
<a  href="http://www.importnew.com/tag/api" class="tag-link-308" title="6 个话题" style="font-size: 8px;">API</a>
<a  href="http://www.importnew.com/tag/arraylist" class="tag-link-314" title="7 个话题" style="font-size: 8.56px;">ArrayList</a>
<a  href="http://www.importnew.com/tag/concurrenthashmap" class="tag-link-355" title="10 个话题" style="font-size: 10.128px;">ConcurrentHashMap</a>
<a  href="http://www.importnew.com/tag/controller" class="tag-link-797" title="7 个话题" style="font-size: 8.56px;">Controller</a>
<a  href="http://www.importnew.com/tag/eclipse" class="tag-link-81" title="27 个话题" style="font-size: 14.72px;">Eclipse</a>
<a  href="http://www.importnew.com/tag/gc" class="tag-link-87" title="35 个话题" style="font-size: 15.952px;">GC</a>
<a  href="http://www.importnew.com/tag/guava" class="tag-link-554" title="11 个话题" style="font-size: 10.576px;">Guava</a>
<a  href="http://www.importnew.com/tag/hadoop" class="tag-link-140" title="13 个话题" style="font-size: 11.36px;">Hadoop</a>
<a  href="http://www.importnew.com/tag/hashmap" class="tag-link-284" title="28 个话题" style="font-size: 14.832px;">HashMap</a>
<a  href="http://www.importnew.com/tag/hashset" class="tag-link-60" title="9 个话题" style="font-size: 9.68px;">HashSet</a>
<a  href="http://www.importnew.com/tag/hbase" class="tag-link-128" title="14 个话题" style="font-size: 11.696px;">HBase</a>
<a  href="http://www.importnew.com/tag/hibernate" class="tag-link-109" title="12 个话题" style="font-size: 10.912px;">Hibernate</a>
<a  href="http://www.importnew.com/tag/intellij" class="tag-link-213" title="8 个话题" style="font-size: 9.12px;">IntelliJ</a>
<a  href="http://www.importnew.com/tag/io" class="tag-link-70" title="11 个话题" style="font-size: 10.576px;">io</a>
<a  href="http://www.importnew.com/tag/java" class="tag-link-35" title="126 个话题" style="font-size: 22px;">Java</a>
<a  href="http://www.importnew.com/tag/java8" class="tag-link-354" title="32 个话题" style="font-size: 15.504px;">java8</a>
<a  href="http://www.importnew.com/tag/java-8" class="tag-link-50" title="32 个话题" style="font-size: 15.504px;">java 8</a>
<a  href="http://www.importnew.com/tag/java9" class="tag-link-436" title="8 个话题" style="font-size: 9.12px;">Java9</a>
<a  href="http://www.importnew.com/tag/javaee" class="tag-link-379" title="6 个话题" style="font-size: 8px;">javaee</a>
<a  href="http://www.importnew.com/tag/javaee%e4%b8%8emaven%e6%95%99%e7%a8%8b" class="tag-link-462" title="7 个话题" style="font-size: 8.56px;">JavaEE与Maven教程</a>
<a  href="http://www.importnew.com/tag/java-gc" class="tag-link-115" title="6 个话题" style="font-size: 8px;">Java GC</a>
<a  href="http://www.importnew.com/tag/java-nio" class="tag-link-750" title="13 个话题" style="font-size: 11.36px;">Java NIO</a>
<a  href="http://www.importnew.com/tag/java%e4%b9%b1%e7%a0%81" class="tag-link-807" title="8 个话题" style="font-size: 9.12px;">Java乱码</a>
<a  href="http://www.importnew.com/tag/java%e7%bc%96%e7%a8%8b%e5%85%a5%e9%97%a8" class="tag-link-639" title="24 个话题" style="font-size: 14.16px;">Java编程入门</a>
<a  href="http://www.importnew.com/tag/java%e8%99%9a%e6%8b%9f%e6%9c%ba" class="tag-link-671" title="7 个话题" style="font-size: 8.56px;">java虚拟机</a>
<a  href="http://www.importnew.com/tag/jdbc" class="tag-link-122" title="15 个话题" style="font-size: 11.92px;">JDBC</a>
<a  href="http://www.importnew.com/tag/jdk" class="tag-link-44" title="10 个话题" style="font-size: 10.128px;">JDK</a>
<a  href="http://www.importnew.com/tag/jpa" class="tag-link-161" title="8 个话题" style="font-size: 9.12px;">JPA</a>
<a  href="http://www.importnew.com/tag/jsoup" class="tag-link-703" title="9 个话题" style="font-size: 9.68px;">Jsoup</a>
<a  href="http://www.importnew.com/tag/junit" class="tag-link-337" title="7 个话题" style="font-size: 8.56px;">JUnit</a>
<a  href="http://www.importnew.com/tag/jvm" class="tag-link-80" title="92 个话题" style="font-size: 20.544px;">JVM</a>
<a  href="http://www.importnew.com/tag/lambda" class="tag-link-92" title="8 个话题" style="font-size: 9.12px;">Lambda</a>
<a  href="http://www.importnew.com/tag/linkedhashmap" class="tag-link-306" title="6 个话题" style="font-size: 8px;">LinkedHashMap</a>
<a  href="http://www.importnew.com/tag/mapreduce" class="tag-link-106" title="7 个话题" style="font-size: 8.56px;">MapReduce</a>
<a  href="http://www.importnew.com/tag/maven" class="tag-link-385" title="14 个话题" style="font-size: 11.696px;">maven</a>
<a  href="http://www.importnew.com/tag/mybatis" class="tag-link-820" title="12 个话题" style="font-size: 10.912px;">Mybatis</a>
<a  href="http://www.importnew.com/tag/netty" class="tag-link-130" title="16 个话题" style="font-size: 12.256px;">Netty</a>
<a  href="http://www.importnew.com/tag/nio" class="tag-link-69" title="16 个话题" style="font-size: 12.256px;">nio</a>
<a  href="http://www.importnew.com/tag/nio2-0" class="tag-link-116" title="6 个话题" style="font-size: 8px;">NIO2.0</a>
<a  href="http://www.importnew.com/tag/oracle" class="tag-link-153" title="9 个话题" style="font-size: 9.68px;">oracle</a>
<a  href="http://www.importnew.com/tag/orm" class="tag-link-451" title="10 个话题" style="font-size: 10.128px;">ORM</a>
<a  href="http://www.importnew.com/tag/restful" class="tag-link-196" title="9 个话题" style="font-size: 9.68px;">RESTful</a>
<a  href="http://www.importnew.com/tag/scala" class="tag-link-89" title="17 个话题" style="font-size: 12.592px;">Scala</a>
<a  href="http://www.importnew.com/tag/scala-tutorial" class="tag-link-155" title="6 个话题" style="font-size: 8px;">Scala tutorial</a>
<a  href="http://www.importnew.com/tag/servlet" class="tag-link-320" title="8 个话题" style="font-size: 9.12px;">Servlet</a>
<a  href="http://www.importnew.com/tag/socket" class="tag-link-559" title="11 个话题" style="font-size: 10.576px;">Socket</a>
<a  href="http://www.importnew.com/tag/solr" class="tag-link-429" title="8 个话题" style="font-size: 9.12px;">solr</a>
<a  href="http://www.importnew.com/tag/spring" class="tag-link-53" title="123 个话题" style="font-size: 21.888px;">Spring</a>
<a  href="http://www.importnew.com/tag/spring4" class="tag-link-771" title="8 个话题" style="font-size: 9.12px;">Spring4</a>
<a  href="http://www.importnew.com/tag/spring-mvc" class="tag-link-443" title="9 个话题" style="font-size: 9.68px;">Spring MVC</a>
<a  href="http://www.importnew.com/tag/springmvc" class="tag-link-614" title="20 个话题" style="font-size: 13.264px;">SpringMVC</a>
<a  href="http://www.importnew.com/tag/string" class="tag-link-252" title="30 个话题" style="font-size: 15.168px;">String</a>
<a  href="http://www.importnew.com/tag/synchronized" class="tag-link-737" title="7 个话题" style="font-size: 8.56px;">synchronized</a>
<a  href="http://www.importnew.com/tag/threadlocal" class="tag-link-376" title="12 个话题" style="font-size: 10.912px;">ThreadLocal</a>
<a  href="http://www.importnew.com/tag/tomcat" class="tag-link-225" title="18 个话题" style="font-size: 12.816px;">Tomcat</a>
<a  href="http://www.importnew.com/tag/volatile" class="tag-link-433" title="9 个话题" style="font-size: 9.68px;">volatile</a>
<a  href="http://www.importnew.com/tag/%e4%ba%8b%e5%8a%a1" class="tag-link-339" title="9 个话题" style="font-size: 9.68px;">事务</a>
<a  href="http://www.importnew.com/tag/%e4%bc%98%e5%8c%96" class="tag-link-171" title="6 个话题" style="font-size: 8px;">优化</a>
<a  href="http://www.importnew.com/tag/%e4%be%9d%e8%b5%96%e6%b3%a8%e5%85%a5" class="tag-link-293" title="6 个话题" style="font-size: 8px;">依赖注入</a>
<a  href="http://www.importnew.com/tag/%e5%86%85%e5%ad%98%e6%b3%84%e9%9c%b2" class="tag-link-124" title="6 个话题" style="font-size: 8px;">内存泄露</a>
<a  href="http://www.importnew.com/tag/%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86" class="tag-link-273" title="17 个话题" style="font-size: 12.592px;">内存管理</a>
<a  href="http://www.importnew.com/tag/%e5%8f%82%e6%95%b0%e5%a4%aa%e5%a4%9a%e6%80%8e%e4%b9%88%e5%8a%9e" class="tag-link-470" title="8 个话题" style="font-size: 9.12px;">参数太多怎么办</a>
<a  href="http://www.importnew.com/tag/%e5%8f%8d%e5%b0%84" class="tag-link-301" title="7 个话题" style="font-size: 8.56px;">反射</a>
<a  href="http://www.importnew.com/tag/%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6" class="tag-link-575" title="14 个话题" style="font-size: 11.696px;">垃圾回收</a>
<a  href="http://www.importnew.com/tag/%e5%9f%ba%e7%a1%80%e6%8a%80%e6%9c%af" class="tag-link-58" title="63 个话题" style="font-size: 18.752px;">基础技术</a>
<a  href="http://www.importnew.com/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b" class="tag-link-46" title="22 个话题" style="font-size: 13.712px;">多线程</a>
<a  href="http://www.importnew.com/tag/%e5%ad%97%e7%ac%a6%e4%b8%b2" class="tag-link-636" title="8 个话题" style="font-size: 9.12px;">字符串</a>
<a  href="http://www.importnew.com/tag/%e5%ad%97%e8%8a%82%e7%a0%81" class="tag-link-38" title="6 个话题" style="font-size: 8px;">字节码</a>
<a  href="http://www.importnew.com/tag/%e5%b7%a5%e5%85%b7" class="tag-link-126" title="6 个话题" style="font-size: 8px;">工具</a>
<a  href="http://www.importnew.com/tag/%e5%b9%b6%e5%8f%91" class="tag-link-401" title="39 个话题" style="font-size: 16.4px;">并发</a>
<a  href="http://www.importnew.com/tag/%e5%b9%b6%e5%8f%91%e7%bc%96%e7%a8%8b" class="tag-link-64" title="25 个话题" style="font-size: 14.272px;">并发编程</a>
<a  href="http://www.importnew.com/tag/%e5%ba%8f%e5%88%97%e5%8c%96" class="tag-link-298" title="10 个话题" style="font-size: 10.128px;">序列化</a>
<a  href="http://www.importnew.com/tag/%e5%bc%82%e5%b8%b8" class="tag-link-83" title="6 个话题" style="font-size: 8px;">异常</a>
<a  href="http://www.importnew.com/tag/%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" class="tag-link-214" title="15 个话题" style="font-size: 11.92px;">异常处理</a>
<a  href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd" class="tag-link-47" title="16 个话题" style="font-size: 12.256px;">性能</a>
<a  href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96" class="tag-link-88" title="16 个话题" style="font-size: 12.256px;">性能优化</a>
<a  href="http://www.importnew.com/tag/%e6%80%a7%e8%83%bd%e8%b0%83%e4%bc%98" class="tag-link-282" title="9 个话题" style="font-size: 9.68px;">性能调优</a>
<a  href="http://www.importnew.com/tag/%e6%8e%92%e5%ba%8f" class="tag-link-368" title="6 个话题" style="font-size: 8px;">排序</a>
<a  href="http://www.importnew.com/tag/%e6%95%99%e7%a8%8b" class="tag-link-156" title="17 个话题" style="font-size: 12.592px;">教程</a>
<a  href="http://www.importnew.com/tag/%e6%95%b0%e7%bb%84" class="tag-link-375" title="6 个话题" style="font-size: 8px;">数组</a>
<a  href="http://www.importnew.com/tag/%e6%97%a5%e5%bf%97" class="tag-link-29" title="10 个话题" style="font-size: 10.128px;">日志</a>
<a  href="http://www.importnew.com/tag/%e6%9e%b6%e6%9e%84" class="tag-link-139" title="8 个话题" style="font-size: 9.12px;">架构</a>
<a  href="http://www.importnew.com/tag/%e6%ad%bb%e9%94%81" class="tag-link-343" title="6 个话题" style="font-size: 8px;">死锁</a>
<a  href="http://www.importnew.com/tag/%e6%b3%9b%e5%9e%8b" class="tag-link-246" title="14 个话题" style="font-size: 11.696px;">泛型</a>
<a  href="http://www.importnew.com/tag/%e6%b3%a8%e8%a7%a3" class="tag-link-360" title="8 个话题" style="font-size: 9.12px;">注解</a>
<a  href="http://www.importnew.com/tag/%e6%b5%8b%e8%af%95" class="tag-link-237" title="8 个话题" style="font-size: 9.12px;">测试</a>
<a  href="http://www.importnew.com/tag/%e6%b8%b8%e6%88%8f" class="tag-link-184" title="9 个话题" style="font-size: 9.68px;">游戏</a>
<a  href="http://www.importnew.com/tag/%e7%ae%97%e6%b3%95" class="tag-link-270" title="6 个话题" style="font-size: 8px;">算法</a>
<a  href="http://www.importnew.com/tag/%e7%ba%bf%e7%a8%8b" class="tag-link-374" title="10 个话题" style="font-size: 10.128px;">线程</a>
<a  href="http://www.importnew.com/tag/%e7%ba%bf%e7%a8%8b%e6%b1%a0" class="tag-link-297" title="12 个话题" style="font-size: 10.912px;">线程池</a>
<a  href="http://www.importnew.com/tag/%e7%bc%93%e5%ad%98" class="tag-link-353" title="7 个话题" style="font-size: 8.56px;">缓存</a>
<a  href="http://www.importnew.com/tag/%e8%99%9a%e6%8b%9f%e6%9c%ba" class="tag-link-685" title="11 个话题" style="font-size: 10.576px;">虚拟机</a>
<a  href="http://www.importnew.com/tag/%e8%a1%8c%e4%b8%9a%e8%b5%84%e8%ae%af" class="tag-link-129" title="6 个话题" style="font-size: 8px;">行业资讯</a>
<a  href="http://www.importnew.com/tag/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f" class="tag-link-30" title="41 个话题" style="font-size: 16.624px;">设计模式</a>
<a  href="http://www.importnew.com/tag/%e8%b5%84%e8%ae%af" class="tag-link-108" title="9 个话题" style="font-size: 9.68px;">资讯</a>
<a  href="http://www.importnew.com/tag/%e9%9d%a2%e8%af%95" class="tag-link-31" title="19 个话题" style="font-size: 13.04px;">面试</a>
<a  href="http://www.importnew.com/tag/%e9%9d%a2%e8%af%95%e9%a2%98" class="tag-link-27" title="11 个话题" style="font-size: 10.576px;">面试题</a></p></div></div></div><div id="text-18" class="widget widget_text">			<div class="textwidget"><p><a  href="http://date.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=rightBanner-2&#038;utm_content=2015.9.16" target="_blank" class="external" rel="nofollow"><img src='http://ww2.sinaimg.cn/mw690/bfdcef89gw1esk2g5dvq1j208c03cglu.jpg' /></a></p>
</div>
		</div><div id="recent_comments_widget-2" class="widget recent_comments_widget">		<h3 class='widget-title'>最新评论</h3>
		<ul>
		
					
			<li id="rc-comment-538679" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22971.html#comment-538679" rel="nofollow">Lock 那点事儿</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				具体的结果根据测试环境会有差别，可以参照一下思路，给出自己的判断哦								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-538499" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22971.html#comment-538499" rel="nofollow">Lock 那点事儿</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				测试结果  怎么跟描述的不一样呢   用JDK自带的平均时间75秒  架构师的60秒  直接加关键字...								<span class="rc-reviewer"> 黑水</span>
								</div>
			</li>
			
						
			<li id="rc-comment-538348" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22821.html#comment-538348" rel="nofollow">几种简单的负载均衡算法及其Jav...</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				谢谢，学习了，以前没了解过这方面的东西，看了您的介绍之后，又学到知识了								<span class="rc-reviewer"> 猫头</span>
								</div>
			</li>
			
						
			<li id="rc-comment-538282" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22914.html#comment-538282" rel="nofollow">Mybatis的ResultMap的使用</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				感谢提醒，已更新								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-538281" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22890.html#comment-538281" rel="nofollow">Quartz 入门详解</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				没错，sleep 10s后把调度的任务结束了。配图和代码有点小出入，恭喜你发现了彩蛋。								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-538280" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22604.html#comment-538280" rel="nofollow">Intellij IDEA 一些不为...</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				可以看看是不是快捷键被系统注册了								<span class="rc-reviewer"> 唐尤华</span>
								</div>
			</li>
			
						
			<li id="rc-comment-537971" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22604.html#comment-537971" rel="nofollow">Intellij IDEA 一些不为...</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				Alt + Enter 没用啊								<span class="rc-reviewer"> 雨停天晴</span>
								</div>
			</li>
			
						
			<li id="rc-comment-537970" class="rc-item rc-comment rc-clearfix">
				<img class="rc-avatar rc-left" width="32" height="32" alt="" src="http://jbcdn2.b0.upaiyun.com/2014/11/cb962c0fddc4ba5282bbf2996f3ee0d2.png">
				<div class="rc-info">
				Re:
				<a  class="rc-post" target="_blank" href="http://www.importnew.com/22783.html#comment-537970" rel="nofollow">MyBatis（1）：MyBatis入门</a>
				</div>
				<div class="rc-timestamp"></div>
				<div class="rc-excerpt">
				感谢分享								<span class="rc-reviewer"> Feedmo</span>
								</div>
			</li>
			
					
		</ul>
        </div><div id="text-19" class="widget widget_text">			<div class="textwidget"><p><a  href="http://fanyi.jobbole.com/" target="_blank" class="external" rel="nofollow"><img src='http://ww1.sinaimg.cn/mw690/bfdcef89gw1esnyzyrczej208c03cgm3.jpg' /></a></p>
</div>
		</div>	
	<!-- BEGIN .container -->
	<div class="container">
	
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<div class="clear"></div>
			
	</div>
	<!-- END .container -->

</div>
<!-- END #sidebar -->
<div class="clear"></div>	


</div>
<!-- END #wrapper -->

<!-- BEGIN footer -->
<footer>

	<!-- BEGIN .container -->
	<div class="container">
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-15" class="widget widget_text"><h3 class="widget-title">关于ImportNew</h3>			<div class="textwidget"><p>ImportNew 专注于 Java 技术分享。于2012年11月11日 11:11正式上线。是的，这是一个很特别的时刻 :) </p>
<p>ImportNew 由两个 Java 关键字 import 和 new 组成，意指：Java 开发者学习新知识的网站。 import 可认为是学习和吸收， new 则可认为是新知识、新技术圈子和新朋友……</p>
<div id="aw_socialcounter_widget-2" class="widget aw_socialcounter_widget">
<ul>
<li>
<a  target="_blank" href="http://weibo.com/importnew" class="external" rel="nofollow"><img class="alignleft" src="http://blog.jobbole.com/common_images/sina_32.png"  alt="关注我们的新浪微博" title="关注我们的新浪微博" /></a></p>
<div class="view-rss"><a  target="_blank" href="http://www.importnew.com/feed/" class="rss-link"><img class="alignleft" src="http://blog.jobbole.com/common_images/rss_32.png"  alt="RSS订阅" title="RSS订阅" /></a></div>
</li>
</ul>
</div>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-17" class="widget widget_text"><h3 class="widget-title">联系我们</h3>			<div class="textwidget"><p>Email：<a  href="mailto:ImportNew.com@gmail.com">ImportNew.com@gmail.com</a><br />
新浪微博：<a  href="http://weibo.com/importnew" target="_blank" class="external" rel="nofollow">@ImportNew</a><br />
推荐微信号<br />
<img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/ImportNew_weixin.png' width='100' height='110' /><img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/android_weixin.png' width='100' height='110' /><img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/Linux_weixin.png' width='100' height='110' /></p>
<p>反馈建议：ImportNew.com@gmail.com<br />
广告与商务合作QQ：2302462408 </p>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<!-- BEGIN .grid-4 -->
		<div class="grid-4">
			
			<div id="text-16" class="widget widget_text"><h3 class="widget-title">推荐关注</h3>			<div class="textwidget"><p><a  href="http://group.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">小组</a> &#8211; 好的话题、有启发的回复、值得信赖的圈子<br />
<a  href="http://top.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">头条</a> &#8211; 写了文章？看干货？去头条！<br />
<a  href="http://date.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">相亲</a> &#8211; 为IT单身男女服务的征婚传播平台<br />
<a  href="http://hao.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">资源</a> &#8211; 优秀的工具资源导航<br />
<a  href="http://fanyi.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">翻译</a> &#8211; 活跃 &#038; 专业的翻译小组<br />
<a  href="http://blog.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">博客</a> &#8211; 国内外的精选博客文章<br />
<a  href="http://design.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">设计</a> &#8211; UI,网页，交互和用户体验<br />
<a  href="http://web.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">前端</a> &#8211; JavaScript, HTML5, CSS<br />
<a  href="http://android.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">安卓</a> &#8211; 专注Android技术分享<br />
<a  href="http://ios.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">iOS</a> &#8211; 专注iOS技术分享<br />
<a  href="http://www.importnew.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank">Java</a> &#8211; 专注Java技术分享<br />
<a  href="http://python.jobbole.com/?utm_source=www.importnew.com&#038;utm_medium=bottomText" target="_blank" class="external" rel="nofollow">Python</a> &#8211; 专注Python技术分享</p>
</div>
		</div>			
		</div>
		<!-- END .grid-4 -->
		
		<div class="clear"></div>
	
	</div>
	<!-- END .container -->

	<!-- BEGIN #bottom -->
	<div id="bottom">
	
		<!-- BEGIN .container -->
		<div class="container">
		
			<!-- BEGIN .grid-12 -->
			<div class="grid-12">
	
				<p>&copy; 2017 ImportNew</p>
			
			</div>
			<!-- END .grid-12 -->
			
			<div class="clear"></div>
						
		</div>
		<!-- END .container -->
		
	</div>
	<!-- END #bottom -->
	
</footer>
<!-- END footer -->


	
<!-- Lightbox Plus v2.3 - 2011.08.11 - Message: 0-->
<script type="text/javascript">
jQuery(document).ready(function($){
  $("a[rel*=lightbox]").colorbox({opacity:0.8});
});
</script>

<!-- WP SyntaxHighlighter Ver.1.7.3 Begin -->
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shLegacy.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shAutoloader.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAppleScript.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSass.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0"></script>
<script type="text/javascript" src="http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0"></script>
<script type="text/javascript">//<![CDATA[
	SyntaxHighlighter.autoloader(
	"applescript	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAppleScript.js?ver=3.0"
	,"as3 actionscript3	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0"
	,"bash shell	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0"
	,"cf coldfusion	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0"
	,"cpp c	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0"
	,"c# c-sharp csharp	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0"
	,"css	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0"
	,"delphi pas pascal	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0"
	,"diff patch	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0"
	,"erl erlang	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0"
	,"groovy	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0"
	,"java	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0"
	,"jfx javafx	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0"
	,"js jscript javascript	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0"
	,"perl pl	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0"
	,"php	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0"
	,"plain text	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0"
	,"ps powershell	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0"
	,"py python	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0"
	,"rails ror ruby rb	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0"
	,"sass scss	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSass.js?ver=3.0"
	,"scala	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0"
	,"sql	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0"
	,"vb vbnet	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0"
	,"xml xhtml xslt html	http://www.importnew.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0"
	);
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['quick-code'] = true;
	SyntaxHighlighter.defaults['title'] = '';
	SyntaxHighlighter.defaults['class-name'] = 'notranslate';
	SyntaxHighlighter.defaults['collapse'] = false;
	SyntaxHighlighter.defaults['first-line'] = 1;
	SyntaxHighlighter.defaults['gutter'] = true;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['smart-tabs'] = true;
	SyntaxHighlighter.defaults['tab-size'] = 4;
	SyntaxHighlighter.defaults['toolbar'] = false;
 SyntaxHighlighter.config.stripBrs = true;
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = "Can't find brush for: ";
	SyntaxHighlighter.config.strings.brushNotHtmlScript = "Brush wasn't configured for html-script option: ";
	SyntaxHighlighter.all();
	dp.SyntaxHighlighter.HighlightAll('code')
//]]></script>
<!-- WP SyntaxHighlighter Ver.1.7.3 End -->
<link rel='stylesheet' id='wp_rp_scrollup-css'  href='http://dtmvdvtzf8rz0.cloudfront.net/static/css-img/scrollup.css?ver=3.4.2' type='text/css' media='all' />
<script type='text/javascript' src='http://www.importnew.com/wp-content/plugins/comment-rating/ck-karma.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/plugins/lightbox-plus/js/jquery.colorbox-min.js?ver=1.3.17.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/www.importnew.com\/wp-admin\/admin-ajax.php","post_id":"18126"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.64'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/ready.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/easing.js?ver=1.3'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/superfish.js?ver=1.4.8'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/validate.js?ver=1.9.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/touchwipe.js?ver=1.1.1'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/caroufredsel.js?ver=5.5.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/flexslider.js?ver=2.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/jplayer.js?ver=2.1.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/fitvids.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/selectnav.js?ver=0.1'></script>
<script type='text/javascript' src='http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/js/effects.js?ver=1.0'></script>
<script type='text/javascript' src='http://dtmvdvtzf8rz0.cloudfront.net/static/js/scrollup.js?ver=3.4.2'></script>


<div id="full-btm" style="position:fixed; left:50%; top:550px;  z-index:100; text-align:center; cursor:pointer;">
<a><img src="http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/img/back-btm.png" width="20" border=0 alt="跳到底部" title="跳到底部"></a>
</div>

<script type="text/javascript">
jQuery('#full-btm').click(function(){
    jQuery('html, body').animate({scrollTop:jQuery(document).height()}, 'slow');
    return false;
});
</script>

<div id="full-top" style="position:fixed; left:50%; top:520px; margin-left:495px; z-index:100; text-align:center; cursor:pointer;">
<a><img src="http://www.importnew.com/wp-content/themes/jobbolev4blog/_assets/img/back-top.png" width="20" border=0 alt="返回顶部" title="返回顶部"></a>
</div>

<script type="text/javascript">
jQuery('#full-top').click(function(){
    jQuery('html, body').animate({scrollTop:0}, 'slow');
    return false;
});
</script>

<!-- script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','/_assets/js/analytics.js','ga');

    ga('create', 'UA-15621043-1', 'jobbole.com');
    ga('send', 'pageview');

</script -->

</body>
<!-- END body -->

</html>
<!-- END html -->
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

 Served from: importnew.com @ 2017-01-06 13:32:00 by W3 Total Cache -->